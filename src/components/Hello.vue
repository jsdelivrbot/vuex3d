<template>
  <div id="artboard">
    <div id="scene">
      <X3D id="x3dscene" version="3.0" PrimitiveQuality="High" showProgress="true" showStat="true" showLog="true" profile="Immersive" xmlns:xsd="http://www.w3.org/2001/XMLSchema-instance" xsd:noNamespaceSchemaLocation="http://www.web3d.org/specifications/x3d-3.0.xsd" width="100" height="100">
        <head>
          <meta name="filename" content="demo.x3d" />
          <meta name="generator" content="Blender 2.78 (sub 0)" />
        </head>
        <Scene>
          <NavigationInfo headlight="false"
                          visibilityLimit="0.0"
                          type='"EXAMINE", "ANY"'
                          avatarSize="0.25, 1.75, 0.75"
                          />
          <Background DEF="WO_World"
                  groundColor="0.92 0.92 0.92"
                  skyColor="0.97 0.97 0.97"
                  />
          <Transform DEF="SketchUp_TRANSFORM"
                    translation="0.000000 0.000000 0.000000"
                    scale="0.1 0.1 0.1"
                    rotation="0.000000 0.707107 0.707107 3.141593"
                    >
            <Transform DEF="group_1_TRANSFORM"
                      translation="-5.000000 -5.000000 5.000000"
                      scale="1.000000 1.000000 1.000000"
                      rotation="1.000000 0.000000 0.000000 0.000000"
                      >
              <Transform DEF="group_1_ifs_TRANSFORM"
                        translation="0.000000 0.000000 -0.000000"
                        scale="1.000000 1.000000 1.000000"
                        rotation="1.000000 0.000000 0.000000 0.000000"
                        >
                <Group DEF="group_ME_ID15">
                  <Shape>
                    <Appearance>
                      <Material DEF="MA_material_2"
                                diffuseColor="1.000 0.514 0.112"
                                specularColor="0.401 0.401 0.401"
                                emissiveColor="0.000 0.000 0.000"
                                ambientIntensity="0.333"
                                shininess="0.098"
                                transparency="0.0"
                                />
                    </Appearance>
                    <IndexedFaceSet solid="true"
                                    coordIndex="0 1 2 -1 1 0 3 -1 4 5 6 -1 7 6 5 -1 12 13 14 -1 13 12 15 -1 16 17 18 -1 19 18 17 -1 22 23 24 -1 23 22 25 -1 26 27 28 -1 29 28 27 -1 31 32 33 -1 32 31 34 -1 35 36 37 -1 38 37 36 -1 40 41 42 -1 41 40 43 -1 44 45 46 -1 47 46 45 -1 48 49 50 -1 49 48 51 -1 52 53 54 -1 55 54 53 -1 "
                                    >
                      <Coordinate DEF="coords_ME_ID15"
                                  point="10.000000 9.000000 10.000000 0.000000 10.000000 10.000000 0.000000 9.000000 10.000000 10.000000 10.000000 10.000000 10.000000 10.000000 10.000000 10.000000 9.000000 10.000000 0.000000 10.000000 10.000000 0.000000 9.000000 10.000000 0.000000 10.000000 10.000000 0.000000 9.000000 10.000000 10.000000 9.000000 10.000000 10.000000 10.000000 10.000000 0.000000 10.000000 10.000000 0.000000 9.000000 0.000000 0.000000 9.000000 10.000000 0.000000 10.000000 0.000000 0.000000 10.000000 0.000000 0.000000 10.000000 10.000000 0.000000 9.000000 0.000000 0.000000 9.000000 10.000000 0.000000 10.000000 0.000000 0.000000 9.000000 0.000000 10.000000 9.000000 10.000000 0.000000 9.000000 0.000000 10.000000 9.000000 0.000000 0.000000 9.000000 10.000000 0.000000 9.000000 10.000000 10.000000 9.000000 10.000000 0.000000 9.000000 0.000000 10.000000 9.000000 0.000000 10.000000 9.000000 0.000000 10.000000 10.000000 0.000000 10.000000 9.000000 10.000000 10.000000 9.000000 0.000000 10.000000 10.000000 10.000000 10.000000 10.000000 10.000000 10.000000 10.000000 0.000000 10.000000 9.000000 10.000000 10.000000 9.000000 0.000000 10.000000 10.000000 0.000000 0.000000 10.000000 10.000000 10.000000 10.000000 0.000000 0.000000 10.000000 0.000000 10.000000 10.000000 10.000000 10.000000 10.000000 10.000000 0.000000 10.000000 10.000000 10.000000 10.000000 0.000000 0.000000 10.000000 0.000000 10.000000 10.000000 0.000000 0.000000 9.000000 0.000000 0.000000 10.000000 0.000000 10.000000 9.000000 0.000000 10.000000 9.000000 0.000000 10.000000 10.000000 0.000000 0.000000 9.000000 0.000000 0.000000 10.000000 0.000000 "
                                  />
                    </IndexedFaceSet>
                  </Shape>
                </Group>
              </Transform>
            </Transform>
            <Transform DEF="group_0_TRANSFORM"
                      translation="-5.000000 -5.000000 -5.000000"
                      scale="1.000000 1.000000 1.000000"
                      rotation="1.000000 0.000000 0.000000 0.000000"
                      >
              <Transform DEF="group_0_ifs_TRANSFORM"
                        translation="0.000000 0.000000 0.000000"
                        scale="1.000000 1.000000 1.000000"
                        rotation="1.000000 0.000000 0.000000 0.000000"
                        >
                <Group DEF="group_ME_ID4">
                  <Shape>
                    <Appearance>
                      <Material DEF="MA_material_3"
                                diffuseColor="1.000 0.992 0.466"
                                specularColor="0.401 0.401 0.401"
                                emissiveColor="0.000 0.000 0.000"
                                ambientIntensity="0.333"
                                shininess="0.098"
                                transparency="0.0"
                                />
                    </Appearance>
                    <IndexedFaceSet solid="true"
                                    coordIndex="0 1 2 -1 1 0 3 -1 4 5 6 -1 7 6 5 -1 12 13 14 -1 13 12 15 -1 16 17 18 -1 19 18 17 -1 22 23 24 -1 23 22 25 -1 26 27 28 -1 29 28 27 -1 31 32 33 -1 32 31 34 -1 35 36 37 -1 38 37 36 -1 40 41 42 -1 41 40 43 -1 44 45 46 -1 47 46 45 -1 48 49 50 -1 49 48 51 -1 52 53 54 -1 55 54 53 -1 "
                                    >
                      <Coordinate DEF="coords_ME_ID4"
                                  point="10.000000 0.000000 10.000000 0.000000 10.000000 10.000000 0.000000 0.000000 10.000000 10.000000 10.000000 10.000000 10.000000 10.000000 10.000000 10.000000 0.000000 10.000000 0.000000 10.000000 10.000000 0.000000 0.000000 10.000000 0.000000 10.000000 10.000000 0.000000 0.000000 10.000000 10.000000 0.000000 10.000000 10.000000 10.000000 10.000000 0.000000 10.000000 10.000000 0.000000 0.000000 0.000000 0.000000 0.000000 10.000000 0.000000 10.000000 0.000000 0.000000 10.000000 0.000000 0.000000 10.000000 10.000000 0.000000 0.000000 0.000000 0.000000 0.000000 10.000000 0.000000 10.000000 0.000000 0.000000 0.000000 0.000000 10.000000 0.000000 10.000000 0.000000 0.000000 0.000000 10.000000 0.000000 0.000000 0.000000 0.000000 10.000000 0.000000 0.000000 10.000000 10.000000 0.000000 10.000000 0.000000 0.000000 0.000000 10.000000 0.000000 0.000000 10.000000 0.000000 0.000000 10.000000 10.000000 0.000000 10.000000 0.000000 10.000000 10.000000 0.000000 0.000000 10.000000 10.000000 10.000000 10.000000 10.000000 10.000000 10.000000 10.000000 0.000000 10.000000 0.000000 10.000000 10.000000 0.000000 0.000000 10.000000 10.000000 0.000000 0.000000 10.000000 10.000000 10.000000 10.000000 0.000000 0.000000 10.000000 0.000000 10.000000 10.000000 10.000000 10.000000 10.000000 10.000000 0.000000 10.000000 10.000000 10.000000 10.000000 0.000000 0.000000 10.000000 0.000000 10.000000 10.000000 0.000000 0.000000 0.000000 0.000000 0.000000 10.000000 0.000000 10.000000 0.000000 0.000000 10.000000 0.000000 0.000000 10.000000 10.000000 0.000000 0.000000 0.000000 0.000000 0.000000 10.000000 0.000000 "
                                  />
                    </IndexedFaceSet>
                  </Shape>
                </Group>
              </Transform>
            </Transform>
          </Transform>
          <Transform DEF="Lamp_TRANSFORM"
                    translation="-4.076245 5.903862 1.005454"
                    scale="1.000000 1.000000 1.000000"
                    rotation="-0.498084 -0.762016 -0.413815 1.513875"
                    >
            <PointLight DEF="LA_Lamp"
                        ambientIntensity="0.3000"
                        color="1.0000 1.0000 1.0000"
                        intensity="0.8"
                        radius="30.0000" 
                        location="-0.0000 -0.0000 0.0000"
                        />
          </Transform>
          <Transform DEF="Camera_TRANSFORM"
                translation="-7.481132 5.343665 -6.507640"
                scale="1.000000 1.000000 1.000000"
                rotation="-0.098233 -0.968789 -0.227591 2.349487"
                >
            <Viewpoint DEF="CA_Camera"
                      centerOfRotation="0 0 0"
                      position="-0.00 -0.00 0.00"
                      orientation="-0.00 -0.47 -0.88 0.00"
                      fieldOfView="0.858"
                      />
          </Transform>
        </Scene>
      </X3D>
    </div>
    <div id="attributes">
      <aside>
        <p>Selected Size</p>
        <p>W: {{currentObject.width}} / H: {{currentObject.height}} / D: {{currentObject.depth}}</p>
      </aside>
    </div>
  </div>
</template>

<script>
export default {
  name: 'x3d',
  data () {
    return {
      currentObject: {
        width: 0,
        height: 0,
        depth: 0
      },
      selectedCoords: null
    }
  },
  created () {
    // window.x3dom.ready = function (element) {
    //   console.log('rea')
    // }
    window.x3dom.runtime.ready = function () {
      console.log('initial')
      var $element = document.getElementById('x3dscene')
      // Adding the click event
      $element.addEventListener('click', function (event) {
        // Get the position of the mouse in the canvas
        console.log('clicked')
        var canvasPos = this.runtime.mousePosition(event)
        // Return an array of shape elements contained in a rect on the canvas (x1,y1 and x2,y2)
        var picked = this.runtime.pickRect(canvasPos[0], canvasPos[1], canvasPos[0], canvasPos[1])
        if (picked.length) {
          // do whatever you want
          console.log(picked[0].children.tagName)
        }
      }, false)
    }
  }
}
</script>

<!-- Add "scoped" attribute to limit CSS to this component only -->
<style lang="scss">
@import '../assets/styles/x3dom';
#artboard {
  height: calc(100vh - 250px);
  display: flex;
  #scene {
    flex: 1;
  }
  #attributes {
    width: 300px;
    position: relative;
    box-shadow: 0 0 24px rgba(0,0,0,0.33);
  }
}
</style>
